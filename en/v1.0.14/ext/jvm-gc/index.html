
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="http://netflix.github.io/spectator/ext/jvm-gc/">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-6.2.8">
    
    
      
        <title>Garbage Collection - Spectator Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/custom.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#garbage-collection" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="http://netflix.github.io/spectator/" title="Spectator Docs" class="md-header-nav__button md-logo" aria-label="Spectator Docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Spectator Docs
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Garbage Collection
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/Netflix/spectator/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="http://netflix.github.io/spectator/" title="Spectator Docs" class="md-nav__button md-logo" aria-label="Spectator Docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Spectator Docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/Netflix/spectator/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
      
      <label class="md-nav__link" for="nav-2">
        Getting Started
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/registry/" class="md-nav__link">
        Registry
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2" >
      
      <label class="md-nav__link" for="nav-2-2">
        Meter Types
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Meter Types" data-md-level="2">
        <label class="md-nav__title" for="nav-2-2">
          <span class="md-nav__icon md-icon"></span>
          Meter Types
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/counter/" class="md-nav__link">
        Counters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/timer/" class="md-nav__link">
        Timers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/gauge/" class="md-nav__link">
        Gauges
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/dist-summary/" class="md-nav__link">
        Distribution Summaries
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/clock/" class="md-nav__link">
        Clock
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/conventions/" class="md-nav__link">
        Naming Conventions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/testing/" class="md-nav__link">
        Testing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/netflix/" class="md-nav__link">
        Netflix Integration
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/servo-comparison/" class="md-nav__link">
        Servo Comparison
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
      
      <label class="md-nav__link" for="nav-3">
        Extensions
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Extensions" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Extensions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ipc/" class="md-nav__link">
        IPC
      </a>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" checked>
      
      <label class="md-nav__link" for="nav-3-2">
        JVM Stats
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="JVM Stats" data-md-level="2">
        <label class="md-nav__title" for="nav-3-2">
          <span class="md-nav__icon md-icon"></span>
          JVM Stats
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../jvm-buffer-pools/" class="md-nav__link">
        Buffer Pools
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Garbage Collection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Garbage Collection
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting Started
  </a>
  
    <nav class="md-nav" aria-label="Getting Started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    Dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-reporting" class="md-nav__link">
    Start Reporting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    Logging
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    Metrics
  </a>
  
    <nav class="md-nav" aria-label="Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jvmgcallocationrate" class="md-nav__link">
    jvm.gc.allocationRate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jvmgcpromotionrate" class="md-nav__link">
    jvm.gc.promotionRate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jvmgclivedatasize" class="md-nav__link">
    jvm.gc.liveDataSize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jvmgcmaxdatasize" class="md-nav__link">
    jvm.gc.maxDataSize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jvmgcpause" class="md-nav__link">
    jvm.gc.pause
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jvmgcconcurrentphasetime" class="md-nav__link">
    jvm.gc.concurrentPhaseTime
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alerting" class="md-nav__link">
    Alerting
  </a>
  
    <nav class="md-nav" aria-label="Alerting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#max-pause-time" class="md-nav__link">
    Max Pause Time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heap-pressure" class="md-nav__link">
    Heap Pressure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../jvm-gc-causes/" class="md-nav__link">
        GC Causes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../jvm-memory-pools/" class="md-nav__link">
        Memory Pools
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../thread-pools/" class="md-nav__link">
        Thread Pools
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../log4j2/" class="md-nav__link">
        Log4j2 Appender
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../log4j1/" class="md-nav__link">
        Log4j1 Appender
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../placeholders/" class="md-nav__link">
        Placeholders
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
      
      <label class="md-nav__link" for="nav-4">
        Registries
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Registries" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Registries
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../registry/metrics3/" class="md-nav__link">
        Metrics3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../registry/servo/" class="md-nav__link">
        Servo
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting Started
  </a>
  
    <nav class="md-nav" aria-label="Getting Started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    Dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-reporting" class="md-nav__link">
    Start Reporting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    Logging
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    Metrics
  </a>
  
    <nav class="md-nav" aria-label="Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jvmgcallocationrate" class="md-nav__link">
    jvm.gc.allocationRate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jvmgcpromotionrate" class="md-nav__link">
    jvm.gc.promotionRate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jvmgclivedatasize" class="md-nav__link">
    jvm.gc.liveDataSize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jvmgcmaxdatasize" class="md-nav__link">
    jvm.gc.maxDataSize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jvmgcpause" class="md-nav__link">
    jvm.gc.pause
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jvmgcconcurrentphasetime" class="md-nav__link">
    jvm.gc.concurrentPhaseTime
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alerting" class="md-nav__link">
    Alerting
  </a>
  
    <nav class="md-nav" aria-label="Alerting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#max-pause-time" class="md-nav__link">
    Max Pause Time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heap-pressure" class="md-nav__link">
    Heap Pressure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Netflix/spectator/edit/master/docs/ext/jvm-gc.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Docs have been moved to the <a href="https://netflix.github.io/atlas-docs/">atlas-docs</a> site. This page is no longer
maintained.</p>
</div>
<h1 id="garbage-collection">Garbage Collection<a class="headerlink" href="#garbage-collection" title="Permanent link">&para;</a></h1>
<p>The GC module registers with the notification emitter of the
<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/management/GarbageCollectorMXBean.html">GarbageCollectorMXBean</a>
to provide some basic GC logging and metrics.</p>
<ul>
<li><a href="#getting-started">Getting started</a></li>
<li><a href="#logging">Logging</a></li>
<li><a href="#metrics">Metrics</a></li>
<li><a href="#alerting">Alerting</a></li>
</ul>
<h2 id="getting-started">Getting Started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h2>
<p>For using it internally at Netflix see the <a href="../../intro/netflix/">Netflix integration</a> guide,
otherwise keep reading this section.</p>
<h3 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h3>
<p>This library relies on the notification emitter added in 7u4, but there are known issues prior
to 7u40. There is also a regression impacting java 9 and higher, see <a href="https://github.com/Netflix/spectator/issues/502">#502</a> and <a href="https://bugs.openjdk.java.net/browse/JDK-8196325">JDK-8196325</a>
for more information. For G1 it is recommended to be on the latest version available.</p>
<h3 id="dependencies">Dependencies<a class="headerlink" href="#dependencies" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code>com.netflix.spectator:spectator-ext-gc:<span class="cp">${</span><span class="n">version</span><span class="cp">}</span>
</code></pre></div>

<h3 id="start-reporting">Start Reporting<a class="headerlink" href="#start-reporting" title="Permanent link">&para;</a></h3>
<p>Then in the initialization for the application:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">com.netflix.spectator.gc.GcLogger</span><span class="p">;</span>
<span class="p">...</span>
<span class="c1">// Keep a single instance of the logger</span>
<span class="n">GcLogger</span> <span class="n">gc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GcLogger</span><span class="p">();</span>
<span class="n">gc</span><span class="p">.</span><span class="na">start</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</code></pre></div>

<h2 id="logging">Logging<a class="headerlink" href="#logging" title="Permanent link">&para;</a></h2>
<p>After GC events an INFO level log message will get reported using slf4j. This makes it easy to
GC events in the context of other log messages for the application. The logger name is
<code>com.netflix.spectator.gc.GcLogger</code> and the message will look like:</p>
<div class="codehilite"><pre><span></span><code><span class="cp">${</span><span class="n">GC_TYPE</span><span class="cp">}</span>: <span class="cp">${</span><span class="n">COLLECTOR_NAME</span><span class="cp">}</span>, id=<span class="cp">${</span><span class="n">N</span><span class="cp">}</span>, at=<span class="cp">${</span><span class="n">START_TIME</span><span class="cp">}</span>, duration=<span class="cp">${</span><span class="n">T</span><span class="cp">}</span>ms, cause=[<span class="cp">${</span><span class="n">CAUSE</span><span class="cp">}</span>], <span class="cp">${</span><span class="n">TOTAL_USAGE_BEFORE</span><span class="cp">}</span> =&gt; <span class="cp">${</span><span class="n">TOTAL_USAGE_AFTER</span><span class="cp">}</span> / <span class="cp">${</span><span class="n">MAX_SIZE</span><span class="cp">}</span> (<span class="cp">${</span><span class="n">PERCENT_USAGE_BEFORE</span><span class="cp">}</span> =&gt; <span class="cp">${</span><span class="n">PERCENT_USAGE_AFTER</span><span class="cp">}</span>)
</code></pre></div>

<p>The id can be used to verify events were not skipped or correlate with other sources like
detailed GC logs. See <a href="../jvm-gc-causes/">GC causes</a> for more details on the possible causes.</p>
<p>Sample:</p>
<div class="codehilite"><pre><span></span><code><span class="mi">2014-08-31</span> <span class="mo">02</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">24</span><span class="p">,</span><span class="mi">724</span>  <span class="n">INFO</span> <span class="p">[</span><span class="n">com</span><span class="p">.</span><span class="n">netflix</span><span class="p">.</span><span class="n">spectator</span><span class="p">.</span><span class="n">gc</span><span class="p">.</span><span class="n">GcLogger</span><span class="p">]</span> <span class="nl">YOUNG</span><span class="p">:</span> <span class="n">ParNew</span><span class="p">,</span> <span class="kt">id</span><span class="o">=</span><span class="mi">5281</span><span class="p">,</span> <span class="n">at</span><span class="o">=</span><span class="n">Sun</span> <span class="n">Aug</span> <span class="mi">31</span> <span class="mo">02</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">24</span> <span class="n">UTC</span> <span class="mi">2014</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">2</span><span class="n">ms</span><span class="p">,</span> <span class="n">cause</span><span class="o">=</span><span class="p">[</span><span class="n">Allocation</span> <span class="n">Failure</span><span class="p">],</span> <span class="mf">0.4</span><span class="n">G</span> <span class="o">=&gt;</span> <span class="mf">0.3</span><span class="n">G</span> <span class="o">/</span> <span class="mf">1.8</span><span class="n">G</span> <span class="p">(</span><span class="mf">24.3</span><span class="o">%</span> <span class="o">=&gt;</span> <span class="mf">16.6</span><span class="o">%</span><span class="p">)</span>
</code></pre></div>

<h2 id="metrics">Metrics<a class="headerlink" href="#metrics" title="Permanent link">&para;</a></h2>
<h3 id="jvmgcallocationrate">jvm.gc.allocationRate<a class="headerlink" href="#jvmgcallocationrate" title="Permanent link">&para;</a></h3>
<p>The allocation rate measures how fast the application is allocating memory. It is a counter
that is incremented after a GC event by the amount <code>youngGen.sizeBeforeGC</code>. Technically, right
now it is:</p>
<p><code>youngGen.sizeBeforeGC - youngGen.sizeAfterGC</code></p>
<p>However, <code>youngGen.sizeAfterGC</code> should be 0 and thus the size of young gen before the GC is
the amount allocated since the previous GC event.</p>
<p><strong>Unit:</strong> bytes/second</p>
<p><strong>Dimensions:</strong> n/a</p>
<h3 id="jvmgcpromotionrate">jvm.gc.promotionRate<a class="headerlink" href="#jvmgcpromotionrate" title="Permanent link">&para;</a></h3>
<p>The promotion rate measures how fast data is being moved from young generation into the old
generation. It is a counter that is incremented after a GC event by the amount:</p>
<p><code>abs(oldGen.sizeAfterGC - oldGen.sizeBeforeGC)</code></p>
<p><strong>Unit:</strong> bytes/second</p>
<p><strong>Dimensions:</strong> n/a</p>
<h3 id="jvmgclivedatasize">jvm.gc.liveDataSize<a class="headerlink" href="#jvmgclivedatasize" title="Permanent link">&para;</a></h3>
<p>The live data size is the size of the old generation after a major GC. The image below shows
how the live data size view compares to a metric showing the current size of the memory pool:</p>
<p><img alt="Live Data Size" src="../../images/live_data_size.png" /></p>
<p><strong>Unit:</strong> bytes</p>
<p><strong>Dimensions:</strong> n/a</p>
<h3 id="jvmgcmaxdatasize">jvm.gc.maxDataSize<a class="headerlink" href="#jvmgcmaxdatasize" title="Permanent link">&para;</a></h3>
<p>Maximum size for the old generation. Primary use-case is for gaining perspective on the the
live data size.</p>
<p><strong>Unit:</strong> bytes</p>
<p><strong>Dimensions:</strong> n/a</p>
<h3 id="jvmgcpause">jvm.gc.pause<a class="headerlink" href="#jvmgcpause" title="Permanent link">&para;</a></h3>
<p>Timer reporting the pause time for a GC event. All of the values reported are stop the world
pauses.</p>
<p><strong>Unit:</strong> seconds</p>
<p><strong>Dimensions:</strong></p>
<ul>
<li><code>action</code>: action performed by the garbage collector
   (<a href="http://docs.oracle.com/javase/7/docs/jre/api/management/extension/com/sun/management/GarbageCollectionNotificationInfo.html#getGcAction()">javadoc</a>).
   There is no guarantee, but the typical values seen are <code>end_of_major_GC</code> and <code>end_of_minor_GC</code>.</li>
<li><code>cause</code>: cause that instigated GC (<a href="http://docs.oracle.com/javase/7/docs/jre/api/management/extension/com/sun/management/GarbageCollectionNotificationInfo.html#getGcCause()">javadoc</a>).
  For an explanation of common causes see the <a href="../jvm-gc-causes/">GC causes</a> page.</li>
</ul>
<h3 id="jvmgcconcurrentphasetime">jvm.gc.concurrentPhaseTime<a class="headerlink" href="#jvmgcconcurrentphasetime" title="Permanent link">&para;</a></h3>
<p>Timer reporting time spent in concurrent phases of CMS.
pauses.</p>
<p><strong>Unit:</strong> seconds</p>
<p><strong>Dimensions:</strong></p>
<ul>
<li><code>action</code>: action performed by the garbage collector
  (<a href="http://docs.oracle.com/javase/7/docs/jre/api/management/extension/com/sun/management/GarbageCollectionNotificationInfo.html#getGcAction()">javadoc</a>).
  There is no guarantee, but the typical values seen are <code>end_of_major_GC</code> and <code>end_of_minor_GC</code>.</li>
<li><code>cause</code>: cause that instigated GC (<a href="http://docs.oracle.com/javase/7/docs/jre/api/management/extension/com/sun/management/GarbageCollectionNotificationInfo.html#getGcCause()">javadoc</a>).
  For an explanation of common causes see the <a href="../jvm-gc-causes/">GC causes</a> page.</li>
</ul>
<h2 id="alerting">Alerting<a class="headerlink" href="#alerting" title="Permanent link">&para;</a></h2>
<p>This section assumes the data is available in <a href="https://github.com/Netflix/atlas/wiki/">Atlas</a>,
but users of other systems should be able to take the idea and make it work. For all of these
alerts it is recommended to check them on instance. At Netflix that can be done by selecting
the option in alert ui:</p>
<blockquote>
<p><img alt="On Instance Alerting" src="../../images/on_instance.png" /></p>
</blockquote>
<h3 id="max-pause-time">Max Pause Time<a class="headerlink" href="#max-pause-time" title="Permanent link">&para;</a></h3>
<p>Example to trigger an alert if the <a href="#jvmgcpause">pause time</a> exceeds 500 milliseconds:</p>
<div class="codehilite"><pre><span></span><code><span class="err">name,jvm.gc.pause,:eq,</span>
<span class="err">statistic,max,:eq,</span>
<span class="err">:and,</span>
<span class="err">:max,(,cause,),:by,</span>
<span class="err">0.5,:gt,</span>
<span class="err">$cause,:legend</span>
</code></pre></div>

<h3 id="heap-pressure">Heap Pressure<a class="headerlink" href="#heap-pressure" title="Permanent link">&para;</a></h3>
<p>Example to trigger an alert if the <a href="#jvmgclivedatasize">live data size</a> is over 70% of the heap:</p>
<div class="codehilite"><pre><span></span><code><span class="err">name,jvm.gc.liveDataSize,:eq,:max,</span>
<span class="err">name,jvm.gc.maxDataSize,:eq,:max,</span>
<span class="err">:div,100,:mul,</span>
<span class="err">70,:gt,</span>
<span class="err">percentUsed,:legend</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../jvm-buffer-pools/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Buffer Pools
              </div>
            </div>
          </a>
        
        
          <a href="../jvm-gc-causes/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                GC Causes
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.18f0862e.min.js"></script>
      <script src="../../assets/javascripts/bundle.994580cf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>